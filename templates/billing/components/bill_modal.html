<div id="bill-modal" 
     x-data="{ open: false, bill: {} }" 
     x-show="open" 
     class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"
     style="display: none;">
    <div class="bg-white p-6 rounded-lg w-full max-w-md shadow-lg">
        <h2 class="text-xl font-semibold mb-4">Patient Bill</h2>

        <p><strong>Patient:</strong> <span x-text="bill.patient_name"></span></p>
        <p><strong>Description:</strong> <span x-text="bill.bill_description"></span></p>
        <p><strong>Amount:</strong> Ksh <span x-text="bill.bill_amount"></span></p>

        <div class="flex justify-end gap-4 mt-6">
            <button @click="open = false"
                class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400">Cancel</button>
            <button @click="payBill(bill.bill_id)"
                class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">Pay</button>
        </div>
    </div>
</div>

<script>
function showBillModal(billData) {
    const modal = document.getElementById("bill-modal").__x;
    modal.bill = billData;
    modal.open = true;
}

function payBill(billId) {
    fetch(`/billing/pay/${billId}/`, {
        method: "POST",
        headers: { "X-CSRFToken": getCookie("csrftoken") }
    })
    .then(res => res.json())
    .then(data => {
        alert(data.success || data.error);
        window.location.reload();
    });
}
</script>
